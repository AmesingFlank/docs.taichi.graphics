<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Differentiable programming | Taichi</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/taichi.graphics/logo.png">
    <meta name="description" content="The Taichi Programming Language">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="og:locale" content="en_US">
    <link rel="preload" href="/taichi.graphics/assets/css/0.styles.2a90f16d.css" as="style"><link rel="preload" href="/taichi.graphics/assets/js/app.e1f120dc.js" as="script"><link rel="preload" href="/taichi.graphics/assets/js/5.9735c49b.js" as="script"><link rel="preload" href="/taichi.graphics/assets/js/35.b36bb05c.js" as="script"><link rel="prefetch" href="/taichi.graphics/assets/js/1.74746e58.js"><link rel="prefetch" href="/taichi.graphics/assets/js/10.c26904af.js"><link rel="prefetch" href="/taichi.graphics/assets/js/100.17e38c6b.js"><link rel="prefetch" href="/taichi.graphics/assets/js/101.f77c3043.js"><link rel="prefetch" href="/taichi.graphics/assets/js/102.2307debb.js"><link rel="prefetch" href="/taichi.graphics/assets/js/103.0bdc384a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/104.3ee36f2f.js"><link rel="prefetch" href="/taichi.graphics/assets/js/105.448bc340.js"><link rel="prefetch" href="/taichi.graphics/assets/js/106.5fcbd74a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/107.fb04e881.js"><link rel="prefetch" href="/taichi.graphics/assets/js/108.72cfeb7d.js"><link rel="prefetch" href="/taichi.graphics/assets/js/109.9611e6a6.js"><link rel="prefetch" href="/taichi.graphics/assets/js/11.e556bc29.js"><link rel="prefetch" href="/taichi.graphics/assets/js/110.19b7224e.js"><link rel="prefetch" href="/taichi.graphics/assets/js/111.b7f7d8c5.js"><link rel="prefetch" href="/taichi.graphics/assets/js/112.ed9bb792.js"><link rel="prefetch" href="/taichi.graphics/assets/js/113.7cede291.js"><link rel="prefetch" href="/taichi.graphics/assets/js/114.cd88e01a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/12.9cc0e4de.js"><link rel="prefetch" href="/taichi.graphics/assets/js/13.2de2c04d.js"><link rel="prefetch" href="/taichi.graphics/assets/js/14.aa06f23a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/15.c7db06dc.js"><link rel="prefetch" href="/taichi.graphics/assets/js/16.6d160a0a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/17.dc7bd45c.js"><link rel="prefetch" href="/taichi.graphics/assets/js/18.ee1b8742.js"><link rel="prefetch" href="/taichi.graphics/assets/js/19.76803106.js"><link rel="prefetch" href="/taichi.graphics/assets/js/2.fdc6023c.js"><link rel="prefetch" href="/taichi.graphics/assets/js/20.03d990c8.js"><link rel="prefetch" href="/taichi.graphics/assets/js/21.d511ed9b.js"><link rel="prefetch" href="/taichi.graphics/assets/js/22.fff3cc8b.js"><link rel="prefetch" href="/taichi.graphics/assets/js/23.913f00e4.js"><link rel="prefetch" href="/taichi.graphics/assets/js/24.49d0c1f4.js"><link rel="prefetch" href="/taichi.graphics/assets/js/25.8aeb6b17.js"><link rel="prefetch" href="/taichi.graphics/assets/js/26.4c763785.js"><link rel="prefetch" href="/taichi.graphics/assets/js/27.666d3fb0.js"><link rel="prefetch" href="/taichi.graphics/assets/js/28.228edcbb.js"><link rel="prefetch" href="/taichi.graphics/assets/js/29.36451e6b.js"><link rel="prefetch" href="/taichi.graphics/assets/js/30.e4665591.js"><link rel="prefetch" href="/taichi.graphics/assets/js/31.df1c49bb.js"><link rel="prefetch" href="/taichi.graphics/assets/js/32.e0c04e68.js"><link rel="prefetch" href="/taichi.graphics/assets/js/33.5a01887c.js"><link rel="prefetch" href="/taichi.graphics/assets/js/34.638bf048.js"><link rel="prefetch" href="/taichi.graphics/assets/js/36.2f62ac7a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/37.aea4d92a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/38.341ecf03.js"><link rel="prefetch" href="/taichi.graphics/assets/js/39.ab623b9a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/4.0bea7c87.js"><link rel="prefetch" href="/taichi.graphics/assets/js/40.f5e73841.js"><link rel="prefetch" href="/taichi.graphics/assets/js/41.839e051a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/42.4236e600.js"><link rel="prefetch" href="/taichi.graphics/assets/js/43.a7bd38b1.js"><link rel="prefetch" href="/taichi.graphics/assets/js/44.4edcfe5a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/45.1b9f2f8b.js"><link rel="prefetch" href="/taichi.graphics/assets/js/46.e2bf0342.js"><link rel="prefetch" href="/taichi.graphics/assets/js/47.509636b0.js"><link rel="prefetch" href="/taichi.graphics/assets/js/48.fa8df703.js"><link rel="prefetch" href="/taichi.graphics/assets/js/49.b6ce6984.js"><link rel="prefetch" href="/taichi.graphics/assets/js/50.e6599a1d.js"><link rel="prefetch" href="/taichi.graphics/assets/js/51.a9d4cff3.js"><link rel="prefetch" href="/taichi.graphics/assets/js/52.b89a971f.js"><link rel="prefetch" href="/taichi.graphics/assets/js/53.e5a31574.js"><link rel="prefetch" href="/taichi.graphics/assets/js/54.fc666cbd.js"><link rel="prefetch" href="/taichi.graphics/assets/js/55.fbc3a8a7.js"><link rel="prefetch" href="/taichi.graphics/assets/js/56.4442b2ca.js"><link rel="prefetch" href="/taichi.graphics/assets/js/57.fe3c3156.js"><link rel="prefetch" href="/taichi.graphics/assets/js/58.350e31a1.js"><link rel="prefetch" href="/taichi.graphics/assets/js/59.3f1de230.js"><link rel="prefetch" href="/taichi.graphics/assets/js/6.8d0ab268.js"><link rel="prefetch" href="/taichi.graphics/assets/js/60.1091dcde.js"><link rel="prefetch" href="/taichi.graphics/assets/js/61.7b0bbdf2.js"><link rel="prefetch" href="/taichi.graphics/assets/js/62.1830c1f7.js"><link rel="prefetch" href="/taichi.graphics/assets/js/63.b071d926.js"><link rel="prefetch" href="/taichi.graphics/assets/js/64.5f6c98ce.js"><link rel="prefetch" href="/taichi.graphics/assets/js/65.70268bab.js"><link rel="prefetch" href="/taichi.graphics/assets/js/66.22590296.js"><link rel="prefetch" href="/taichi.graphics/assets/js/67.55ef6733.js"><link rel="prefetch" href="/taichi.graphics/assets/js/68.ee43a0c8.js"><link rel="prefetch" href="/taichi.graphics/assets/js/69.c60f8d76.js"><link rel="prefetch" href="/taichi.graphics/assets/js/7.43d1544c.js"><link rel="prefetch" href="/taichi.graphics/assets/js/70.b9967667.js"><link rel="prefetch" href="/taichi.graphics/assets/js/71.8fdbd8cd.js"><link rel="prefetch" href="/taichi.graphics/assets/js/72.4450cea5.js"><link rel="prefetch" href="/taichi.graphics/assets/js/73.09ed003b.js"><link rel="prefetch" href="/taichi.graphics/assets/js/74.4b21c71f.js"><link rel="prefetch" href="/taichi.graphics/assets/js/75.d2aefe65.js"><link rel="prefetch" href="/taichi.graphics/assets/js/76.0e2e31d8.js"><link rel="prefetch" href="/taichi.graphics/assets/js/77.5ddcbc55.js"><link rel="prefetch" href="/taichi.graphics/assets/js/78.f6781664.js"><link rel="prefetch" href="/taichi.graphics/assets/js/79.6f325512.js"><link rel="prefetch" href="/taichi.graphics/assets/js/8.e232f2a6.js"><link rel="prefetch" href="/taichi.graphics/assets/js/80.23e19b92.js"><link rel="prefetch" href="/taichi.graphics/assets/js/81.681c3f2a.js"><link rel="prefetch" href="/taichi.graphics/assets/js/82.f8997b3c.js"><link rel="prefetch" href="/taichi.graphics/assets/js/83.fdd03bd9.js"><link rel="prefetch" href="/taichi.graphics/assets/js/84.6c915b6f.js"><link rel="prefetch" href="/taichi.graphics/assets/js/85.04f2a2cf.js"><link rel="prefetch" href="/taichi.graphics/assets/js/86.7fc33fa6.js"><link rel="prefetch" href="/taichi.graphics/assets/js/87.22aa1bb3.js"><link rel="prefetch" href="/taichi.graphics/assets/js/88.620cd493.js"><link rel="prefetch" href="/taichi.graphics/assets/js/89.38716740.js"><link rel="prefetch" href="/taichi.graphics/assets/js/9.3f3d2be3.js"><link rel="prefetch" href="/taichi.graphics/assets/js/90.cc6eedf5.js"><link rel="prefetch" href="/taichi.graphics/assets/js/91.0a9cb107.js"><link rel="prefetch" href="/taichi.graphics/assets/js/92.91083609.js"><link rel="prefetch" href="/taichi.graphics/assets/js/93.6306e5f9.js"><link rel="prefetch" href="/taichi.graphics/assets/js/94.701b4991.js"><link rel="prefetch" href="/taichi.graphics/assets/js/95.2e36a211.js"><link rel="prefetch" href="/taichi.graphics/assets/js/96.42b8567d.js"><link rel="prefetch" href="/taichi.graphics/assets/js/97.d838a8ed.js"><link rel="prefetch" href="/taichi.graphics/assets/js/98.f9b72925.js"><link rel="prefetch" href="/taichi.graphics/assets/js/99.be09e54f.js">
    <link rel="stylesheet" href="/taichi.graphics/assets/css/0.styles.2a90f16d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/taichi.graphics/" class="home-link router-link-active"><img src="/taichi.graphics/logo_medium.png" alt="Taichi" class="logo"> <span class="site-name can-hide">Taichi</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Documentation" class="dropdown-title"><span class="title">Documentation</span> <span class="arrow down"></span></button> <button type="button" aria-label="Documentation" class="mobile-dropdown-title"><span class="title">Documentation</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/taichi.graphics/versioned_docs/develop/documentation/overview/overview.html" class="nav-link">
  develop
</a></li></ul></div></div><div class="nav-item"><a href="/taichi.graphics/tutorials/" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Explore
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/taichi.graphics/gallery/" class="nav-link">
  Gallery
</a></li><li class="dropdown-subitem"><a href="/taichi.graphics/research/" class="nav-link">
  Research
</a></li><li class="dropdown-subitem"><a href="http://hub.taichi.graphics/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Taichi Hub Playground
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          Resources
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/taichi.graphics/contribution/" class="nav-link">
  Contribution Guide
</a></li><li class="dropdown-subitem"><a href="/taichi.graphics/events/" class="nav-link">
  Events
</a></li><li class="dropdown-subitem"><a href="https://github.com/taichi-dev/taichi/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          FAQ
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/taichi.graphics/faq/" class="nav-link">
  FAQ
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://forum.taichi.graphics/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/taichi.graphics/zh/versioned_docs/develop/documentation/advanced/differentiable_programming.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/taichi-dev/taichi" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Documentation" class="dropdown-title"><span class="title">Documentation</span> <span class="arrow down"></span></button> <button type="button" aria-label="Documentation" class="mobile-dropdown-title"><span class="title">Documentation</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/taichi.graphics/versioned_docs/develop/documentation/overview/overview.html" class="nav-link">
  develop
</a></li></ul></div></div><div class="nav-item"><a href="/taichi.graphics/tutorials/" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          Explore
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/taichi.graphics/gallery/" class="nav-link">
  Gallery
</a></li><li class="dropdown-subitem"><a href="/taichi.graphics/research/" class="nav-link">
  Research
</a></li><li class="dropdown-subitem"><a href="http://hub.taichi.graphics/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Taichi Hub Playground
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          Resources
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/taichi.graphics/contribution/" class="nav-link">
  Contribution Guide
</a></li><li class="dropdown-subitem"><a href="/taichi.graphics/events/" class="nav-link">
  Events
</a></li><li class="dropdown-subitem"><a href="https://github.com/taichi-dev/taichi/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>
          FAQ
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/taichi.graphics/faq/" class="nav-link">
  FAQ
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://forum.taichi.graphics/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Forum
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Languages" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/taichi.graphics/zh/versioned_docs/develop/documentation/advanced/differentiable_programming.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/taichi-dev/taichi" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Overview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Basic Concepts</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Advanced Programming</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html" class="sidebar-link">Metaprogramming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html#template-metaprogramming" class="sidebar-link">Template metaprogramming</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html#dimensionality-independent-programming-using-grouped-indices" class="sidebar-link">Dimensionality-independent programming using grouped indices</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html#field-metadata" class="sidebar-link">Field metadata</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html#matrix-vector-metadata" class="sidebar-link">Matrix &amp; vector metadata</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html#compile-time-evaluations" class="sidebar-link">Compile-time evaluations</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/meta.html#when-to-use-for-loops-with-ti-static" class="sidebar-link">When to use for loops with ti.static</a></li></ul></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html" class="sidebar-link">Advanced dense layouts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html#from-shape-to-ti-root-x" class="sidebar-link">From shape to ti.root.X</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html#row-major-versus-column-major" class="sidebar-link">Row-major versus column-major</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html#array-of-structures-aos-structure-of-arrays-soa" class="sidebar-link">Array of Structures (AoS), Structure of Arrays (SoA)</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html#flat-layouts-versus-hierarchical-layouts" class="sidebar-link">Flat layouts versus hierarchical layouts</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html#struct-fors-on-advanced-dense-data-layouts" class="sidebar-link">Struct-fors on advanced dense data layouts</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/layout.html#examples" class="sidebar-link">Examples</a></li></ul></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/sparse.html" class="sidebar-link">Sparse computation (WIP)</a></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html" aria-current="page" class="active sidebar-link">Differentiable programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html#using-ti-tape" class="sidebar-link">Using ti.Tape()</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html#usage-example" class="sidebar-link">Usage example</a></li></ul></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html#using-kernel-grad" class="sidebar-link">Using kernel.grad()</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html#kernel-simplicity-rule" class="sidebar-link">Kernel Simplicity Rule</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/differentiable_programming.html#difftaichi" class="sidebar-link">DiffTaichi</a></li></ul></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/performance.html" class="sidebar-link">Performance tuning</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/performance.html#for-loop-decorators" class="sidebar-link">For-loop decorators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/performance.html#thread-hierarchy-of-gpus" class="sidebar-link">Thread hierarchy of GPUs</a></li><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/performance.html#api-reference" class="sidebar-link">API reference</a></li></ul></li></ul></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/odop.html" class="sidebar-link">Objective data-oriented programming</a></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/syntax_sugars.html" class="sidebar-link">Syntax sugars</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/syntax_sugars.html#aliases" class="sidebar-link">Aliases</a></li></ul></li><li><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/offset.html" class="sidebar-link">Coordinate offsets</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API References</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Miscellaneous</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Acknowledgments</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Legacy</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="differentiable-programming"><a href="#differentiable-programming" class="header-anchor">#</a> Differentiable programming</h1> <p>We suggest starting with the <code>ti.Tape()</code>, and then migrate to more
advanced differentiable programming using the <code>kernel.grad()</code> syntax if
necessary.</p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>For example, you have the following kernel:</p> <div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">compute_y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> ti<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>Now if you want to get the derivative of y corresponding to x, i.e.,
dy/dx. You may want to implement the derivative kernel by yourself:</p> <div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dy_dx <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">compute_dy_dx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dy_dx<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> ti<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>But wait, what if I changed the original <code>compute_y</code>? We will have to
recalculate the derivative by hand and rewrite <code>compute_dy_dx</code> again,
which is very error-prone and not convenient at all.</p> <p>If you run into this situation, don't worry! Taichi provides a handy autodiff system that can help you obtain the derivative of a kernel without any pain!</p> <h2 id="using-ti-tape"><a href="#using-ti-tape" class="header-anchor">#</a> Using <code>ti.Tape()</code></h2> <p>Let's still take the <code>compute_y</code> in above example for explaination.
What's the most convienent way to obtain a kernel that computes x to
<mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="5.887ex" height="2.262ex" viewBox="0 -750 2602 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(520, 0)"><path data-c="79" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1010, 0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(1510, 0)"><path data-c="64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(2030, 0)"><path data-c="78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g></g></svg></mjx-container>?</p> <ol><li>Use the <code>needs_grad=True</code> option when declaring fields involved in
the derivative chain.</li> <li>Use <code>with ti.Tape(y):</code> to embrace the invocation into kernel(s) you
want to compute derivative.</li> <li>Now <code>x.grad[None]</code> is the dy/dx value at current x.</li></ol> <div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> needs_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> needs_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">compute_y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    y<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> ti<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> ti<span class="token punctuation">.</span>Tape<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    compute_y<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dy/dx ='</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>grad<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'at x ='</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>It's equivalant to:</p> <div class="language-python extra-class"><pre class="language-python"><code>x <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
dy_dx <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">compute_dy_dx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dy_dx<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">=</span> ti<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

compute_dy_dx<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dy/dx ='</span><span class="token punctuation">,</span> dy_dx<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'at x ='</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="usage-example"><a href="#usage-example" class="header-anchor">#</a> Usage example</h3> <p>For a physical simulation, sometimes it could be easy to compute the
energy but hard to compute the force on each particles.</p> <p>But recall that we can differentiate (negative) potential energy to get
forces. a.k.a.: <mjx-container jax="SVG" class="MathJax"><svg xmlns="http://www.w3.org/2000/svg" width="14.076ex" height="2.262ex" viewBox="0 -750 6221.5 1000" style="vertical-align:-0.566ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="46" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path></g><g data-mml-node="mi" transform="translate(643, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1214.7, 0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(2270.5, 0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(3048.5, 0)"><path data-c="64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(3568.5, 0)"><path data-c="55" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></g><g data-mml-node="TeXAtom" transform="translate(4335.5, 0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(4835.5, 0)"><path data-c="64" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="msub" transform="translate(5355.5, 0)"><g data-mml-node="mi"><path data-c="78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(572, -150) scale(0.707)"><path data-c="69" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg></mjx-container>. So once you've write a kernel that
is able to compute the potential energy, you may use Taichi's autodiff
system to obtain the derivative of it and then the force on each
particles.</p> <p>Take
<a href="https://github.com/taichi-dev/taichi/blob/master/examples/ad_gravity.py" target="_blank" rel="noopener noreferrer">examples/ad_gravity.py<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
as an example:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> taichi <span class="token keyword">as</span> ti
ti<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span>

N <span class="token operator">=</span> <span class="token number">8</span>
dt <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span>

x <span class="token operator">=</span> ti<span class="token punctuation">.</span>Vector<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">,</span> N<span class="token punctuation">,</span> needs_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># position of particles</span>
v <span class="token operator">=</span> ti<span class="token punctuation">.</span>Vector<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>  <span class="token comment"># velocity of particles</span>
U <span class="token operator">=</span> ti<span class="token punctuation">.</span>field<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> needs_grad<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># potential energy</span>


<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">compute_U</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span> j <span class="token keyword">in</span> ti<span class="token punctuation">.</span>ndrange<span class="token punctuation">(</span>N<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> x<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        <span class="token comment"># r.norm(1e-3) is equivalent to ti.sqrt(r.norm()**2 + 1e-3)</span>
        <span class="token comment"># This is to prevent 1/0 error which can cause wrong derivative</span>
        U<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">/</span> r<span class="token punctuation">.</span>norm<span class="token punctuation">(</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># U += -1 / |r|</span>


<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">advance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>
        v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> dt <span class="token operator">*</span> <span class="token operator">-</span>x<span class="token punctuation">.</span>grad<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  <span class="token comment"># dv/dt = -dU/dx</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> dt <span class="token operator">*</span> v<span class="token punctuation">[</span>i<span class="token punctuation">]</span>  <span class="token comment"># dx/dt = v</span>


<span class="token keyword">def</span> <span class="token function">substep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> ti<span class="token punctuation">.</span>Tape<span class="token punctuation">(</span>U<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># every kernel invocation within this indent scope</span>
        <span class="token comment"># will also be accounted into the partial derivate of U</span>
        <span class="token comment"># with corresponding input variables like x.</span>
        compute_U<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># will also computes dU/dx and save in x.grad</span>
    advance<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>ti<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>


init<span class="token punctuation">(</span><span class="token punctuation">)</span>
gui <span class="token operator">=</span> ti<span class="token punctuation">.</span>GUI<span class="token punctuation">(</span><span class="token string">'Autodiff gravity'</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> gui<span class="token punctuation">.</span>running<span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        substep<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'U = '</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    gui<span class="token punctuation">.</span>circles<span class="token punctuation">(</span>x<span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> radius<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    gui<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="custom-block note"><p class="custom-block-title">NOTE</p> <p>The argument <code>U</code> to <code>ti.Tape(U)</code> must be a 0D field.</p> <p>For using autodiff with multiple output variables, please see the
<code>kernel.grad()</code> usage below.</p></div> <div class="custom-block note"><p class="custom-block-title">NOTE</p> <p><code>ti.Tape(U)</code> will automatically set <em><code>U[None]</code></em> to 0 on
start up.</p></div> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>See
<a href="https://github.com/taichi-dev/taichi/blob/master/examples/mpm_lagrangian_forces.py" target="_blank" rel="noopener noreferrer">examples/mpm_lagrangian_forces.py<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
and
<a href="https://github.com/taichi-dev/taichi/blob/master/examples/fem99.py" target="_blank" rel="noopener noreferrer">examples/fem99.py<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
for examples on using autodiff for MPM and FEM.</p></div> <h2 id="using-kernel-grad"><a href="#using-kernel-grad" class="header-anchor">#</a> Using <code>kernel.grad()</code></h2> <p>TODO: Documentation WIP.</p> <h2 id="kernel-simplicity-rule"><a href="#kernel-simplicity-rule" class="header-anchor">#</a> Kernel Simplicity Rule</h2> <p>Unlike tools such as TensorFlow where <strong>immutable</strong> output buffers are
generated, the <strong>imperative</strong> programming paradigm adopted in Taichi
allows programmers to freely modify global fields.</p> <p>To make automatic differentiation well-defined under this setting, we
make the following assumption on Taichi programs for differentiable
programming:</p> <p><strong>Global Data Access Rules:</strong></p> <ul><li>If a global field element is written more than once, then starting
from the second write, the write <strong>must</strong> come in the form of an
atomic add (&quot;accumulation&quot;, using <code>ti.atomic_add</code> or simply
<code>+=</code>).</li> <li>No read accesses happen to a global field element, until its
accumulation is done.</li></ul> <p><strong>Kernel Simplicity Rule:</strong> Kernel body consists of multiple [simply
nested]{.title-ref} for-loops. I.e., each for-loop can either contain
exactly one (nested) for-loop (and no other statements), or a group of
statements without loops.</p> <p>Example:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@ti<span class="token punctuation">.</span>kernel</span>
<span class="token keyword">def</span> <span class="token function">differentiable_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>
        x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> do whatever you want<span class="token punctuation">,</span> <span class="token keyword">as</span> <span class="token builtin">long</span> <span class="token keyword">as</span> there are no loops

    <span class="token comment"># Not allowed. The outer for loop contains two for loops</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>Taichi programs that violate this rule will result in an error.</p> <div class="custom-block note"><p class="custom-block-title">NOTE</p> <p><strong>static for-loops</strong> (e.g. <code>for i in ti.static(range(4))</code>) will get
unrolled by the Python frontend preprocessor and therefore does not
count as a level of loop.</p></div> <h2 id="difftaichi"><a href="#difftaichi" class="header-anchor">#</a> DiffTaichi</h2> <p>The <a href="https://github.com/yuanming-hu/difftaichi" target="_blank" rel="noopener noreferrer">DiffTaichi repo<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
contains 10 differentiable physical simulators built with Taichi
differentiable programming. A few examples with neural network
controllers optimized using differentiable simulators and brute-force
gradient descent:</p> <p><img src="https://github.com/yuanming-hu/public_files/raw/master/learning/difftaichi/ms3_final-cropped.gif" alt="image"></p> <p><img src="https://github.com/yuanming-hu/public_files/raw/master/learning/difftaichi/rb_final2.gif" alt="image"></p> <p><img src="https://github.com/yuanming-hu/public_files/raw/master/learning/difftaichi/diffmpm3d.gif" alt="image"></p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Check out <a href="https://arxiv.org/pdf/1910.00935.pdf" target="_blank" rel="noopener noreferrer">the DiffTaichi paper<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
and <a href="https://www.youtube.com/watch?v=Z1xvAZve9aE" target="_blank" rel="noopener noreferrer">video<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to learn more
about Taichi differentiable programming.</p></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/taichi-dev/taichi.graphics/edit/master/versioned_docs/develop/documentation/advanced/differentiable_programming.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/8/2020, 2:38:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/sparse.html" class="prev">
        Sparse computation (WIP)
      </a></span> <span class="next"><a href="/taichi.graphics/versioned_docs/develop/documentation/advanced/performance.html">
        Performance tuning
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/taichi.graphics/assets/js/app.e1f120dc.js" defer></script><script src="/taichi.graphics/assets/js/5.9735c49b.js" defer></script><script src="/taichi.graphics/assets/js/35.b36bb05c.js" defer></script>
  </body>
</html>
